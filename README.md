# vulnerability_detect
在基于补丁的漏洞发现中，用于确定差异函数是否是漏洞函数

共检测了五大类的程序漏洞／异常，包括：
1. heap 堆： 堆溢出、释放后重用、双重释放
2. stack 栈：栈内存写溢出
3. memory leak 内存泄漏：内存分配后被释放则为泄漏
4. fully constrained：程序输入受外界不安全控制（如存在文件读取、网络接收等，则可能/Users/pengjiaqi/Documents/iie/binary_analyses/差异函数漏洞检测/README_html.rtf引入异常）
5. format string 格式化字符串

对于每类异常，均有各自的代码进行检测，比如：若需检测堆相关异常，则进入 "1 heap" 文件夹，运行codes目录下的代码。
具体来说：</br>
&emsp;&emsp;运行 python heap_orig.py <orig_binary>  <func_addr> 对补丁前程序的某一函数进行异常检测</br>
&emsp;&emsp;&emsp;&emsp;若检测出异常，则输出 具体异常类型、存在异常的路径基本块序列 至文件 detect_result_heap.txt 中</br></br>
&emsp;&emsp;运行 python heap_patch.py <orig_binary> <orig_func_addr> <patch_binary> <patch_func_addr> 对补丁后程序进行异常检测</br>
&emsp;&emsp;&emsp;&emsp;读取detect_result_heap.txt中的路径信息，对补丁前程序沿着异常路径执行，收集变量和路径约束的对应信息  =>  run_original_function()</br>
&emsp;&emsp;&emsp;&emsp;获取补丁前程序的目标函数的参数，用于后续的变量对比和约束迁移   => get_args()</br>
&emsp;&emsp;&emsp;&emsp;对补丁前程序进行微执行，每执行一步则根据补丁前后变量名的差异修改路径约束中的相关项，并在当前状态中添加上新约束项，从而可以确定step的方向 => run_patched_function()</br>
&emsp;&emsp;&emsp;&emsp;在微执行同时，运行类似于heap_orig.py的异常检测插桩代码，并输出检测结果至stdout  =>  heap_patch_core.py
